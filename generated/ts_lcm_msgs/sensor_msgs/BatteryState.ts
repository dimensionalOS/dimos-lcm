// Auto-generated by lcm-ts. DO NOT EDIT.

import { Header } from "../std_msgs/Header.ts";

export class BatteryState {
  static readonly _HASH = 0x8f419fb94c3b774dn;
  static readonly _NAME = "sensor_msgs.BatteryState";
  private static _packedFingerprint: bigint | null = null;

  static readonly POWER_SUPPLY_STATUS_UNKNOWN = 0;
  static readonly POWER_SUPPLY_STATUS_CHARGING = 1;
  static readonly POWER_SUPPLY_STATUS_DISCHARGING = 2;
  static readonly POWER_SUPPLY_STATUS_NOT_CHARGING = 3;
  static readonly POWER_SUPPLY_STATUS_FULL = 4;
  static readonly POWER_SUPPLY_HEALTH_UNKNOWN = 0;
  static readonly POWER_SUPPLY_HEALTH_GOOD = 1;
  static readonly POWER_SUPPLY_HEALTH_OVERHEAT = 2;
  static readonly POWER_SUPPLY_HEALTH_DEAD = 3;
  static readonly POWER_SUPPLY_HEALTH_OVERVOLTAGE = 4;
  static readonly POWER_SUPPLY_HEALTH_UNSPEC_FAILURE = 5;
  static readonly POWER_SUPPLY_HEALTH_COLD = 6;
  static readonly POWER_SUPPLY_HEALTH_WATCHDOG_TIMER_EXPIRE = 7;
  static readonly POWER_SUPPLY_HEALTH_SAFETY_TIMER_EXPIRE = 8;
  static readonly POWER_SUPPLY_TECHNOLOGY_UNKNOWN = 0;
  static readonly POWER_SUPPLY_TECHNOLOGY_NIMH = 1;
  static readonly POWER_SUPPLY_TECHNOLOGY_LION = 2;
  static readonly POWER_SUPPLY_TECHNOLOGY_LIPO = 3;
  static readonly POWER_SUPPLY_TECHNOLOGY_LIFE = 4;
  static readonly POWER_SUPPLY_TECHNOLOGY_NICD = 5;
  static readonly POWER_SUPPLY_TECHNOLOGY_LIMN = 6;

  cell_voltage_length: number;
  cell_temperature_length: number;
  header: Header;
  voltage: number;
  temperature: number;
  current: number;
  charge: number;
  capacity: number;
  design_capacity: number;
  percentage: number;
  power_supply_status: number;
  power_supply_health: number;
  power_supply_technology: number;
  present: boolean;
  cell_voltage: number[];
  cell_temperature: number[];
  location: string;
  serial_number: string;

  constructor(init?: Partial<BatteryState>) {
    this.cell_voltage_length = init?.cell_voltage_length ?? 0;
    this.cell_temperature_length = init?.cell_temperature_length ?? 0;
    this.header = init?.header ?? new Header();
    this.voltage = init?.voltage ?? 0;
    this.temperature = init?.temperature ?? 0;
    this.current = init?.current ?? 0;
    this.charge = init?.charge ?? 0;
    this.capacity = init?.capacity ?? 0;
    this.design_capacity = init?.design_capacity ?? 0;
    this.percentage = init?.percentage ?? 0;
    this.power_supply_status = init?.power_supply_status ?? 0;
    this.power_supply_health = init?.power_supply_health ?? 0;
    this.power_supply_technology = init?.power_supply_technology ?? 0;
    this.present = init?.present ?? false;
    this.cell_voltage = init?.cell_voltage ?? [];
    this.cell_temperature = init?.cell_temperature ?? [];
    this.location = init?.location ?? "";
    this.serial_number = init?.serial_number ?? "";
  }

  static decode(data: Uint8Array): BatteryState {
    const view = new DataView(data.buffer, data.byteOffset, data.byteLength);
    let offset = 0;

    // Verify fingerprint (recursive hash including nested types)
    const hash = view.getBigUint64(offset, false);
    offset += 8;
    const expectedHash = BatteryState._getPackedFingerprint();
    if (hash !== expectedHash) {
      throw new Error(`Hash mismatch: expected ${expectedHash.toString(16)}, got ${hash.toString(16)}`);
    }

    const result = new BatteryState();
    ({ offset } = BatteryState._decodeOne(view, offset, result));
    return result;
  }

  static _decodeOne(view: DataView, offset: number, target: BatteryState): { offset: number } {
    target.cell_voltage_length = view.getInt32(offset, false);
    offset += 4;
    target.cell_temperature_length = view.getInt32(offset, false);
    offset += 4;
    target.header = new Header();
    ({ offset } = Header._decodeOne(view, offset, target.header));
    target.voltage = view.getFloat32(offset, false);
    offset += 4;
    target.temperature = view.getFloat32(offset, false);
    offset += 4;
    target.current = view.getFloat32(offset, false);
    offset += 4;
    target.charge = view.getFloat32(offset, false);
    offset += 4;
    target.capacity = view.getFloat32(offset, false);
    offset += 4;
    target.design_capacity = view.getFloat32(offset, false);
    offset += 4;
    target.percentage = view.getFloat32(offset, false);
    offset += 4;
    target.power_supply_status = view.getUint8(offset);
    offset += 1;
    target.power_supply_health = view.getUint8(offset);
    offset += 1;
    target.power_supply_technology = view.getUint8(offset);
    offset += 1;
    target.present = view.getInt8(offset) !== 0;
    offset += 1;
    target.cell_voltage = new Array(target.cell_voltage_length);
    for (let i0 = 0; i0 < target.cell_voltage_length; i0++) {
      target.cell_voltage[i0] = view.getFloat32(offset, false);
      offset += 4;
    }
    target.cell_temperature = new Array(target.cell_temperature_length);
    for (let i0 = 0; i0 < target.cell_temperature_length; i0++) {
      target.cell_temperature[i0] = view.getFloat32(offset, false);
      offset += 4;
    }
    {
      const len = view.getUint32(offset, false);
      offset += 4;
      target.location = new TextDecoder().decode(new Uint8Array(view.buffer, view.byteOffset + offset, len - 1));
      offset += len;
    }
    {
      const len = view.getUint32(offset, false);
      offset += 4;
      target.serial_number = new TextDecoder().decode(new Uint8Array(view.buffer, view.byteOffset + offset, len - 1));
      offset += len;
    }
    return { offset };
  }

  encode(): Uint8Array {
    const size = 8 + this._encodedSize();
    const data = new Uint8Array(size);
    const view = new DataView(data.buffer);
    let offset = 0;

    // Write fingerprint (recursive hash including nested types)
    view.setBigUint64(offset, BatteryState._getPackedFingerprint(), false);
    offset += 8;

    offset = this._encodeOne(view, offset);
    return data;
  }

  _encodeOne(view: DataView, offset: number): number {
    view.setInt32(offset, this.cell_voltage_length, false);
    offset += 4;
    view.setInt32(offset, this.cell_temperature_length, false);
    offset += 4;
    offset = this.header._encodeOne(view, offset);
    view.setFloat32(offset, this.voltage, false);
    offset += 4;
    view.setFloat32(offset, this.temperature, false);
    offset += 4;
    view.setFloat32(offset, this.current, false);
    offset += 4;
    view.setFloat32(offset, this.charge, false);
    offset += 4;
    view.setFloat32(offset, this.capacity, false);
    offset += 4;
    view.setFloat32(offset, this.design_capacity, false);
    offset += 4;
    view.setFloat32(offset, this.percentage, false);
    offset += 4;
    view.setUint8(offset, this.power_supply_status);
    offset += 1;
    view.setUint8(offset, this.power_supply_health);
    offset += 1;
    view.setUint8(offset, this.power_supply_technology);
    offset += 1;
    view.setInt8(offset, this.present ? 1 : 0);
    offset += 1;
    for (let i0 = 0; i0 < this.cell_voltage_length; i0++) {
      view.setFloat32(offset, this.cell_voltage[i0], false);
      offset += 4;
    }
    for (let i0 = 0; i0 < this.cell_temperature_length; i0++) {
      view.setFloat32(offset, this.cell_temperature[i0], false);
      offset += 4;
    }
    {
      const encoded = new TextEncoder().encode(this.location);
      view.setUint32(offset, encoded.length + 1, false);
      offset += 4;
      new Uint8Array(view.buffer, view.byteOffset + offset).set(encoded);
      offset += encoded.length;
      view.setUint8(offset, 0); // null terminator
      offset += 1;
    }
    {
      const encoded = new TextEncoder().encode(this.serial_number);
      view.setUint32(offset, encoded.length + 1, false);
      offset += 4;
      new Uint8Array(view.buffer, view.byteOffset + offset).set(encoded);
      offset += encoded.length;
      view.setUint8(offset, 0); // null terminator
      offset += 1;
    }
    return offset;
  }

  _encodedSize(): number {
    let size = 0;
    size += 4;
    size += 4;
    size += this.header._encodedSize();
    size += 4;
    size += 4;
    size += 4;
    size += 4;
    size += 4;
    size += 4;
    size += 4;
    size += 1;
    size += 1;
    size += 1;
    size += 1;
    size += this.cell_voltage_length * 4;
    size += this.cell_temperature_length * 4;
    size += 4 + new TextEncoder().encode(this.location).length + 1;
    size += 4 + new TextEncoder().encode(this.serial_number).length + 1;
    return size;
  }

  // deno-lint-ignore no-explicit-any
  static _getHashRecursive(parents: any[]): bigint {
    if (parents.includes(BatteryState)) return 0n;
    const newparents = [...parents, BatteryState];
    let tmphash = BatteryState._HASH;
    tmphash = (tmphash + Header._getHashRecursive(newparents)) & 0xffffffffffffffffn;
    tmphash = (((tmphash << 1n) & 0xffffffffffffffffn) + (tmphash >> 63n)) & 0xffffffffffffffffn;
    return tmphash;
  }

  static _getPackedFingerprint(): bigint {
    if (BatteryState._packedFingerprint === null) {
      BatteryState._packedFingerprint = BatteryState._getHashRecursive([]);
    }
    return BatteryState._packedFingerprint;
  }
}
